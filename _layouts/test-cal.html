<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ page.title | default: "التقويم الجامعي - iOS Style" }}</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Baloo+Bhaijaan+2:wght@400..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <link rel="icon" href="{{ '/images/favicon.png' | relative_url }}" type="image/jpg">
  <meta property="og:title" content="{{ page.title | default: 'روافد' }}">
  <meta property="og:description" content="التقويم الأكاديمي لجامعة الشرقية.">
  <meta property="og:image" content="{{ '/images/cover.png' | relative_url }}">
  <meta property="og:url" content="{{ page.url | absolute_url }}">

  <script>
    (function() {
      const savedTheme = localStorage.getItem('rawafed-theme');
      if (savedTheme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
      } else {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>

  <style>
    /* === Global Variables === */
    :root {
      --primary-color: #007AFF; /* iOS Blue */
      --danger-color: #FF3B30;  /* iOS Red */
      --text-main: #000000;
      --text-secondary: #8E8E93;
      --bg-body: #F2F2F7;
      --bg-card: #FFFFFF;
      --border-color: #C6C6C8;
      --separator: #E5E5EA;
    }

    [data-theme="dark"] {
      --primary-color: #0A84FF;
      --danger-color: #FF453A;
      --text-main: #FFFFFF;
      --text-secondary: #8E8E93;
      --bg-body: #000000;
      --bg-card: #1C1C1E;
      --border-color: #38383A;
      --separator: #38383A;
    }

    body {
      background-color: var(--bg-body);
      color: var(--text-main);
      font-family: "IBM Plex Sans Arabic", -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      padding-top: 80px; /* Space for Header */
      padding-bottom: 40px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 0 15px;
    }

    /* === Header Style === */
    .page-header {
      margin-bottom: 20px;
      padding: 0 10px;
    }
    .page-header h1 {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 5px;
    }
    .page-header p {
      color: var(--text-secondary);
      font-size: 1rem;
    }

    /* === List Container (iOS Grouped List) === */
    .calendar-group {
      background: var(--bg-card);
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 30px;
      box-shadow: 0 1px 10px rgba(0,0,0,0.05);
    }

    .group-header {
      padding: 15px 20px;
      background: var(--bg-body); /* Sticky feel */
      color: var(--text-secondary);
      font-size: 0.9rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* === Event Row (The Item) === */
    .event-row {
      display: flex;
      padding: 15px 20px;
      background: var(--bg-card);
      border-bottom: 1px solid var(--separator);
      transition: background 0.2s;
      position: relative;
    }

    .event-row:last-child { border-bottom: none; }

    /* Left Column: Date */
    .date-col {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-width: 60px;
      margin-left: 20px;
      padding-top: 2px;
    }

    .date-month {
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--danger-color); /* Red for month like iOS */
      text-transform: uppercase;
      line-height: 1;
      margin-bottom: 2px;
    }

    .date-day {
      font-size: 1.6rem;
      font-weight: 300;
      color: var(--text-main);
      line-height: 1;
    }

    /* Right Column: Content */
    .content-col {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .week-label {
      font-size: 0.75rem;
      color: var(--primary-color);
      font-weight: 600;
      margin-bottom: 4px;
    }

    .event-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 4px;
      line-height: 1.3;
    }

    .event-desc {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.4;
    }

    .event-desc i { margin-left: 5px; opacity: 0.8; }

    /* === Current Week Highlight === */
    .event-row.current {
      background: rgba(0, 122, 255, 0.08); /* Light Blue Tint */
      border-right: 4px solid var(--primary-color);
    }
    
    .event-row.current .date-day {
      color: var(--primary-color);
      font-weight: 600;
    }

    /* === Past Events Toggle === */
    .history-toggle {
      text-align: center;
      margin-bottom: 20px;
    }
    
    .btn-toggle {
      background: rgba(0,0,0,0.05);
      border: none;
      padding: 8px 16px;
      border-radius: 20px;
      color: var(--primary-color);
      font-weight: 500;
      cursor: pointer;
      font-size: 0.9rem;
      transition: 0.2s;
    }
    .btn-toggle:hover { background: rgba(0,0,0,0.1); }
    
    /* Animation for hiding/showing */
    .hidden-section {
      display: none;
      animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

  </style>
</head>
<body>

  {% include header.html %}

  <div class="container">
    <div class="page-header">
      <h1>التقويم الجامعي</h1>
      <p>2025 - 2026</p>
    </div>

    <div class="history-toggle">
      <button class="btn-toggle" onclick="togglePastEvents()" id="toggleBtn">
        <i class="fas fa-history"></i> إظهار الأسابيع الماضية
      </button>
    </div>

    <div id="past-container" class="hidden-section">
      <div class="group-header">الأحداث المنقضية</div>
      <div class="calendar-group" id="past-list">
        </div>
    </div>

    <div id="upcoming-container">
      <div class="group-header">القادم</div>
      <div class="calendar-group" id="upcoming-list">
        
        <div class="event-row" data-date="2025-09-14">
          <div class="date-col">
            <span class="date-month">سبتمبر</span>
            <span class="date-day">14</span>
          </div>
          <div class="content-col">
            <span class="week-label">أسبوع 0 - التهيئة</span>
            <div class="event-title">أسبوع التسجيل والتوجيه</div>
            <div class="event-desc">
                <div><i class="fas fa-check-circle"></i> بدء التسجيل واختبارات تحديد المستوى</div>
            </div>
          </div>
        </div>

        <div class="event-row" data-date="2025-09-21">
          <div class="date-col">
            <span class="date-month">سبتمبر</span>
            <span class="date-day">21</span>
          </div>
          <div class="content-col">
            <span class="week-label">أسبوع 1 - الدراسة</span>
            <div class="event-title">بدء الفصول الدراسية</div>
            <div class="event-desc"><i class="fas fa-university"></i> بداية المحاضرات وفترة الحذف والإضافة</div>
          </div>
        </div>

        <div class="event-row" data-date="2025-10-26">
            <div class="date-col">
              <span class="date-month">أكتوبر</span>
              <span class="date-day">26</span>
            </div>
            <div class="content-col">
              <span class="week-label">أسبوع 6</span>
              <div class="event-title">الامتحان الأول</div>
              <div class="event-desc">تاريخ مقترح للاختبارات الدورية الأولى</div>
            </div>
        </div>

        <div class="event-row" data-date="2025-11-16">
            <div class="date-col">
              <span class="date-month">نوفمبر</span>
              <span class="date-day">16</span>
            </div>
            <div class="content-col">
              <span class="week-label">أسبوع 9</span>
              <div class="event-title" style="color:var(--danger-color)">إجازة العيد الوطني</div>
              <div class="event-desc">إجازة رسمية (يومين بعد 20 نوفمبر)</div>
            </div>
        </div>

        <div class="event-row" data-date="2026-01-04">
            <div class="date-col">
              <span class="date-month">يناير</span>
              <span class="date-day">04</span>
            </div>
            <div class="content-col">
              <span class="week-label">الاختبارات</span>
              <div class="event-title">الامتحانات النهائية (خريف)</div>
              [cite_start]<div class="event-desc">فترة الامتحانات النهائية لمدة أسبوعين [cite: 3]</div>
            </div>
        </div>

        <div class="event-row" data-date="2026-02-01">
            <div class="date-col">
              <span class="date-month">فبراير</span>
              <span class="date-day">01</span>
            </div>
            <div class="content-col">
              <span class="week-label">أسبوع 0 - ربيع 26</span>
              <div class="event-title">التسجيل والتهيئة (ربيع)</div>
              <div class="event-desc"><i class="fas fa-clipboard-list"></i> فترة تسجيل واختبارات مستوى</div>
            </div>
        </div>

        <div class="event-row" data-date="2026-02-08">
            <div class="date-col">
              <span class="date-month">فبراير</span>
              <span class="date-day">08</span>
            </div>
            <div class="content-col">
              <span class="week-label">أسبوع 1</span>
              <div class="event-title">بدء الدراسة (ربيع)</div>
              [cite_start]<div class="event-desc">بداية المحاضرات والحذف والإضافة [cite: 4]</div>
            </div>
        </div>

        <div class="event-row" data-date="2026-02-19">
            <div class="date-col">
              <span class="date-month">فبراير</span>
              <span class="date-day">19</span>
            </div>
            <div class="content-col">
              <span class="week-label">مناسبة</span>
              <div class="event-title" style="color:var(--primary-color)">بداية شهر رمضان</div>
              [cite_start]<div class="event-desc">التاريخ تقريبي [cite: 4]</div>
            </div>
        </div>

        <div class="event-row" data-date="2026-03-22">
            <div class="date-col">
              <span class="date-month">مارس</span>
              <span class="date-day">22</span>
            </div>
            <div class="content-col">
              <span class="week-label">أسبوع 7</span>
              <div class="event-title" style="color:var(--danger-color)">إجازة عيد الفطر</div>
              [cite_start]<div class="event-desc">نهاية رمضان (20 مارس) وإجازة العيد [cite: 4]</div>
            </div>
        </div>

        <div class="event-row" data-date="2026-05-24">
            <div class="date-col">
              <span class="date-month">مايو</span>
              <span class="date-day">24</span>
            </div>
            <div class="content-col">
              <span class="week-label">النهائية</span>
              <div class="event-title">الامتحانات النهائية (ربيع)</div>
              [cite_start]<div class="event-desc">فترة أسبوعين للامتحانات [cite: 4]</div>
            </div>
        </div>

        <div class="event-row" data-date="2026-06-14">
            <div class="date-col">
              <span class="date-month">يونيو</span>
              <span class="date-day">14</span>
            </div>
            <div class="content-col">
              <span class="week-label">أسبوع 1 - صيف</span>
              <div class="event-title">بدء الفصل الصيفي</div>
              [cite_start]<div class="event-desc">تسجيل وبدء الدراسة وإجازة رأس السنة الهجرية [cite: 5]</div>
            </div>
        </div>

      </div> </div> </div> {% include footer.html %}

  <script>
    function organizeEvents() {
        const today = new Date();
        // تصفير الوقت للمقارنة الدقيقة بالتواريخ فقط
        today.setHours(0,0,0,0);

        const allEvents = Array.from(document.querySelectorAll('.event-row'));
        const pastList = document.getElementById('past-list');
        const upcomingList = document.getElementById('upcoming-list');

        let hasPastEvents = false;

        allEvents.forEach(event => {
            const eventDateStr = event.getAttribute('data-date');
            const eventDate = new Date(eventDateStr);
            
            // إضافة 7 أيام للتاريخ ليعتبر الأسبوع "ماضياً" فقط بعد انتهائه تماماً
            const weekEndDate = new Date(eventDate);
            weekEndDate.setDate(weekEndDate.getDate() + 7);

            if (weekEndDate < today) {
                // هذا حدث ماضي
                pastList.appendChild(event);
                hasPastEvents = true;
            } else {
                // هذا حدث قادم أو حالي
                upcomingList.appendChild(event);

                // التحقق إذا كان هذا هو الأسبوع الحالي (داخل نطاق 7 أيام)
                if (today >= eventDate && today < weekEndDate) {
                    event.classList.add('current');
                    // إضافة كلمة "الحالي" بجانب التاريخ
                    const label = event.querySelector('.week-label');
                    label.innerHTML = '<i class="fas fa-dot-circle"></i> ' + label.innerHTML;
                }
            }
        });

        // إخفاء زر "إظهار السابق" إذا لم تكن هناك أحداث سابقة
        if (!hasPastEvents) {
            document.getElementById('toggleBtn').style.display = 'none';
        }
    }

    function togglePastEvents() {
        const container = document.getElementById('past-container');
        const btn = document.getElementById('toggleBtn');
        
        if (container.style.display === 'block') {
            container.style.display = 'none';
            btn.innerHTML = '<i class="fas fa-history"></i> إظهار الأسابيع الماضية';
        } else {
            container.style.display = 'block';
            btn.innerHTML = '<i class="fas fa-chevron-up"></i> إخفاء الأسابيع الماضية';
        }
    }

    // تشغيل الترتيب عند التحميل
    document.addEventListener('DOMContentLoaded', organizeEvents);
  </script>

</body>
</html>
