<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>روبوت الدردشة الآلي</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* المتغيرات */
        :root {
            --bg: #f3f6f9;
            --card: #ffffff;
            --muted: #64748b;
            --accent: #1a2ac6;    
            --text: #0f172a;
            --border: rgba(15, 23, 42, 0.04);
            --shadow: rgba(15, 23, 42, 0.06);
            --user-bubble: #1a2ac6;
            --user-text: #ffffff;
            --success: #2233de;
            --warning: #f59e0b;
            
            /* أحجام الخطوط النسبية */
            --font-sm: 0.875rem;
            --font-md: 1rem;
            --font-lg: 1.125rem;
            --font-xl: 1.25rem;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html, body {
            height: 100%;
            width: 100%;
        }
        
        body {
            font-family: 'Cairo', system-ui, Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            padding: 0;
        }
        
        /* حاوية رئيسية بدون حواف */
        .container {
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
            max-width: 100%;
            padding: 0;
            margin: 0;
        }
        
        /* شعار البوت في أعلى يمين الشاشة */
        .logo-wrap {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 10;
        }
        
        .logo {
            width: 4.25rem;
            height: 4.25rem;
            object-fit: cover;
            border-radius: 0.75rem;
            box-shadow: 0 0.375rem 1.125rem var(--shadow);
            border: 1px solid var(--border);
        }
        
        .card {
            background: var(--card);
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
            border: none;
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
            max-width: 100%;
        }
        
        header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1.125rem 1.25rem;
            border-bottom: 1px solid var(--border);
            background: var(--card);
            position: relative;
        }
        
        header .title {
            font-weight: 700;
            font-size: var(--font-xl);
        }
        
        /* مساحة المحادثة - بخلفية بيضاء */
        #chat {
            flex: 1;
            padding: 1.125rem;
            overflow: auto;
            background: linear-gradient(180deg, #ffffff, #fbfdff);
            min-height: 300px;
            width: 100%;
        }
        
        .messages {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .bubble {
            max-width: 85%;
            padding: 0.75rem 0.875rem;
            border-radius: 0.75rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-break: break-word;
        }
        
        .user {
            align-self: flex-start;
            background: var(--user-bubble);
            color: var(--user-text);
            border: 1px solid rgba(14, 165, 164, 0.2);
            box-shadow: 0 4px 12px rgba(14, 165, 164, 0.1);
        }
        
        .bot {
            align-self: flex-end;
            background: #ffffff;
            color: var(--text);
            border: 1px solid rgba(14, 165, 132, 0.08);
            box-shadow: 0 0.25rem 0.75rem rgba(14, 165, 132, 0.03);
        }
        
        /* نموذج الإرسال */
        form {
            display: flex;
            gap: 0.5rem;
            padding: 0.875rem;
            border-top: 1px solid var(--border);
            align-items: center;
            background: var(--card);
        }
        
        textarea {
            flex: 1;
            min-height: 3.5rem;
            resize: vertical;
            padding: 0.625rem 0.75rem;
            border-radius: 0.625rem;
            border: 1px solid var(--border);
            font-size: var(--font-md);
            font-family: 'Cairo', sans-serif;
            max-height: 200px;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        textarea:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(14, 165, 164, 0.2);
            outline: none;
        }
        
        /* زر الإرسال أيقونة */
        .send-btn {
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 0.625rem;
            display: inline-grid;
            place-items: center;
            background: var(--accent);
            color: #fff;
            border: none;
            cursor: pointer;
            flex-shrink: 0;
            transition: all 0.2s ease;
        }
        
        .send-btn:hover {
            background: #0d9493;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(14, 165, 132, 0.2);
        }
        
        .send-btn:disabled {
            opacity: .6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .meta {
            padding: 0.75rem 1.125rem;
            font-size: var(--font-sm);
            color: var(--muted);
            border-top: 1px solid var(--border);
            background: var(--card);
        }
        
        /* استجابة صغيرة عند كتابة النظام */
        .system-note {
            padding: 0.625rem 1rem;
            font-size: var(--font-sm);
            color: var(--muted);
            background: linear-gradient(90deg, #f8fafc, #ffffff);
            border-top: 1px solid rgba(15, 23, 42, 0.02);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* زر مسح المحادثة */
        .clear-btn {
            background: transparent;
            border: none;
            color: var(--muted);
            cursor: pointer;
            font-size: 1.1rem;
            padding: 0.5rem;
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .clear-btn:hover {
            color: #ef4444;
        }
        
        .save-notice {
            color: var(--success);
            font-size: 0.85rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            background: rgba(16, 185, 129, 0.1);
            animation: fadeIn 0.5s;
        }
        
        .command-notice {
            color: var(--warning);
            font-size: 0.85rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            background: rgba(245, 158, 11, 0.1);
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* مؤشر تحميل */
        .loader {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid rgba(14, 165, 164, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent);
            animation: spin 1s linear infinite;
            margin-right: 5px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* أزرار الروابط */
        .link-buttons-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }
        
        .link-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            text-decoration: none;
            color: #475569;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }
        
        .link-button:hover {
            background-color: #f1f5f9;
            border-color: #cbd5e1;
            transform: translateY(-1px);
        }
        
        .link-button img {
            width: 16px;
            height: 16px;
            object-fit: contain;
        }
        
        /* استجابات للشاشات المختلفة */
        @media (max-width: 768px) {
            :root {
                --font-sm: 0.8125rem;
                --font-md: 0.9375rem;
                --font-lg: 1rem;
                --font-xl: 1.125rem;
            }
            
            .logo {
                width: 3.5rem;
                height: 3.5rem;
            }
            
            .bubble {
                max-width: 90%;
            }
        }
        
        @media (max-width: 640px) {
            .logo-wrap {
                top: 0.5rem;
                right: 0.5rem;
            }
            
            header {
                padding: 0.875rem;
            }
            
            #chat {
                padding: 0.75rem;
            }
            
            .bubble {
                max-width: 95%;
                padding: 0.625rem 0.75rem;
            }
            
            form {
                padding: 0.625rem;
            }
            
            textarea {
                min-height: 3rem;
                font-size: 16px;
            }
            
            .send-btn {
                width: 3rem;
                height: 3rem;
            }
        }
        
        @media (max-width: 480px) {
            .bubble {
                max-width: 100%;
            }
            
            .meta {
                padding: 0.5rem;
                text-align: center;
            }
            
            header {
                flex-direction: column;
                gap: 0.25rem;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo-wrap">
            <img class="logo" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBmaWxsPSJub25lIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI0OCIgZmlsbD0iIzFhMmFjNiIgc3Ryb2tlPSIjZmZmIiBzdHJva2Utd2lkdGg9IjIiLz48cGF0aCBkPSJNMzAgNDBIMzVWNjBIMzBWMzVINDBWNjBINDBWNDBINDBINzBWNjBINzBWNBIzNVYzNUgzMFY0MFoiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJNNjAgNDBINzBWNTBINjBWNjBINTVWNTBINjBWNDBaIiBmaWxsPSIjZmZmIi8+PC9zdmc+" alt="شعار الروبوت">
        </div>
        
        <div class="card">
            <header>
                <button class="clear-btn" title="مسح المحادثة">🗑️</button>
                <div class="title">مساعد الذكاء الاصطناعي</div>
            </header>
            
            <div id="chat">
                <div class="messages">
                    <div class="bubble bot">
                        مرحباً! أنا مساعدك الافتراضي. كيف يمكنني مساعدتك اليوم؟
                    </div>
                </div>
            </div>
            
            <form id="chat-form">
                <textarea id="message-input" placeholder="اكتب رسالتك هنا..." required></textarea>
                <button type="submit" class="send-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </form>
            
            <div class="meta">
                <span>مساعد ذكي &bull; يدعم اللغة العربية</span>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const chatForm = document.getElementById('chat-form');
            const messageInput = document.getElementById('message-input');
            const chatContainer = document.getElementById('chat');
            const messagesContainer = document.querySelector('.messages');
            const clearBtn = document.querySelector('.clear-btn');
            
            // قاعدة المعرفة للردود
            const responses = {
                'مرحبا': ['مرحباً بك!', 'أهلاً وسهلاً!', 'مرحباً، كيف يمكنني مساعدتك؟'],
                'اهلا': ['أهلاً وسهلاً!', 'مرحباً بك!', 'أهلاً بك، كيف يمكنني مساعدتك؟'],
                'كيف حالك': ['أنا بخير، شكراً لسؤالك!', 'الحمد لله، وأتمنى أن تكون أنت أيضاً بخير', 'أنا جيد، شكراً! كيف حالك؟'],
                'شكرا': ['العفو!', 'على الرحب والسعة!', 'أنت دائماً welcome!'],
                'اسمك': ['أنا مساعد الذكاء الاصطناعي', 'يمكنك مناداتي بمساعد', 'أنا برنامج دردشة مصمم لمساعدتك'],
                'مساعدة': ['كيف يمكنني مساعدتك؟', 'أنا هنا للمساعدة، ما الذي تحتاجه؟', 'ما هي استفساراتك؟'],
                'الوقت': ['أنا لا أملك صلاحية الوصول إلى الوقت الحالي', 'يمكنك معرفة الوقت من ساعتك أو جهازك', 'معذرة، ليس لدي إمكانية الوصول إلى الوقت'],
                'التاريخ': ['أنا لا أستطيع الوصول إلى التاريخ الحالي', 'يمكنك التحقق من التاريخ في جهازك', 'معذرة، لا أملك هذه المعلومة'],
                'من انت': ['أنا مساعد ذكي مصمم للرد على استفساراتك', 'أنا برنامج محادثة آلي', 'مساعدك الافتراضي الجاهز لمساعدتك'],
                'ماذا تعمل': ['أجيب على أسئلتك وأقدم المساعدة في مختلف المواضيع', 'أقدم المعلومات والإجابات على استفساراتك', 'أنا هنا للمساعدة في الإجابة على أسئلتك']
            };
            
            // حفظ واسترجاع المحادثة من localStorage
            function saveChat() {
                const chatHTML = messagesContainer.innerHTML;
                localStorage.setItem('chatHistory', chatHTML);
                
                // إظهار إشعار الحفظ
                const notice = document.createElement('div');
                notice.className = 'save-notice';
                notice.textContent = 'تم حفظ المحادثة';
                document.querySelector('.meta').prepend(notice);
                
                setTimeout(() => {
                    notice.remove();
                }, 2000);
            }
            
            function loadChat() {
                const savedChat = localStorage.getItem('chatHistory');
                if (savedChat) {
                    messagesContainer.innerHTML = savedChat;
                    scrollToBottom();
                }
            }
            
            // مسح المحادثة
            function clearChat() {
                messagesContainer.innerHTML = '<div class="bubble bot">مرحباً! أنا مساعدك الافتراضي. كيف يمكنني مساعدتك اليوم؟</div>';
                localStorage.removeItem('chatHistory');
                
                // إظهار إشعار المسح
                const notice = document.createElement('div');
                notice.className = 'command-notice';
                notice.textContent = 'تم مسح المحادثة';
                document.querySelector('.meta').prepend(notice);
                
                setTimeout(() => {
                    notice.remove();
                }, 2000);
            }
            
            // التمرير إلى الأسفل
            function scrollToBottom() {
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
            
            // إضافة رسالة إلى الدردشة
            function addMessage(text, isUser = false) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `bubble ${isUser ? 'user' : 'bot'}`;
                messageDiv.textContent = text;
                
                messagesContainer.appendChild(messageDiv);
                scrollToBottom();
                saveChat();
            }
            
            // محاكاة الكتابة للبوت
            function typeMessage(text, callback) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'bubble bot';
                
                messagesContainer.appendChild(messageDiv);
                
                let i = 0;
                const speed = 30;
                
                function typeWriter() {
                    if (i < text.length) {
                        messageDiv.textContent += text.charAt(i);
                        i++;
                        setTimeout(typeWriter, speed);
                    } else {
                        scrollToBottom();
                        if (callback) callback();
                    }
                }
                
                typeWriter();
            }
            
            // توليد رد من البوت
            function generateResponse(userMessage) {
                userMessage = userMessage.toLowerCase().replace(/[؟?]/g, '');
                
                // البحث عن تطابق في قاعدة المعرفة
                for (const keyword in responses) {
                    if (userMessage.includes(keyword)) {
                        const possibleResponses = responses[keyword];
                        return possibleResponses[Math.floor(Math.random() * possibleResponses.length)];
                    }
                }
                
                // الردود الافتراضية إذا لم يتم العثور على تطابق
                const defaultResponses = [
                    "لم أفهم سؤالك تماماً، هل يمكنك توضيح ذلك؟",
                    "هذا سؤال مثير للاهتمام، لكنني لا أملك إجابة محددة عليه حالياً",
                    "أعتذر، لا أستطيع المساعدة في هذا الموضوع حالياً",
                    "هل يمكنك إعادة صياغة سؤالك؟",
                    "أنا متخصص في الإجابة على الأسئلة العامة، هل لديك سؤال آخر؟"
                ];
                
                return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
            }
            
            // معالجة إرسال النموذج
            chatForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const message = messageInput.value.trim();
                if (!message) return;
                
                // إضافة رسالة المستخدم
                addMessage(message, true);
                messageInput.value = '';
                
                // محاكاة التحميل
                const loadingDiv = document.createElement('div');
                loadingDiv.className = 'bubble bot';
                loadingDiv.innerHTML = '<span class="loader"></span> جاري الكتابة...';
                messagesContainer.appendChild(loadingDiv);
                scrollToBottom();
                
                // توليد الرد بعد تأخير لمحاكاة معالجة الطلب
                setTimeout(() => {
                    loadingDiv.remove();
                    const response = generateResponse(message);
                    typeMessage(response);
                }, 1000);
            });
            
            // مسح المحادثة عند النقر على الزر
            clearBtn.addEventListener('click', clearChat);
            
            // تحميل المحادثة المحفوظة عند البدء
            loadChat();
            
            // جعل textarea تتوسع تلقائياً مع المحتوى
            messageInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });
            
            // السماح بإرسال الرسالة بالضغط على Enter (ولكن مع منع إنشاء سطر جديد باستخدام Shift+Enter)
            messageInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    chatForm.dispatchEvent(new Event('submit'));
                }
            });
        });
    </script>
</body>
</html>
